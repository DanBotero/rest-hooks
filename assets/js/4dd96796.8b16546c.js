(self.webpackChunk=self.webpackChunk||[]).push([[96586],{84195:(e,t,n)=>{"use strict";n.d(t,{Z:()=>a});const a=(0,n(67294).createContext)({selectedValue:"",setSelectedValue:e=>{throw new Error("No Tab provider")},values:[]})},70720:(e,t,n)=>{"use strict";n.d(t,{Z:()=>ke});var a=n(67294),r=n(24861),i=n(88300),l=n(71481),s=n(42910),o=n(99876),c=n(63312),u=n(52803),d=n(44431),m=n.n(d),p=n(53775);class h extends p.Z{constructor(...e){super(...e),this.id=0}pk(){return`${this.id}`}static partialUpdate(){const e=super.partialUpdate();return e.extend({fetch:async(t,n)=>({...await e(t,n),id:t.id})})}static create(){const e=super.create();return e.extend({fetch:async(t,n)=>({...await e(t,n),id:n.id})})}}class k extends h{constructor(...e){super(...e),this.userId=0,this.title="",this.completed=!1}static partialUpdate(){return super.partialUpdate().extend({schema:this,optimisticUpdate:y})}static create(){const e=this.list().key({});return super.create().extend({schema:this,optimisticUpdate:f,update:t=>({[e]:(e=[])=>[...e,t]})})}static delete(){return super.delete().extend({optimisticUpdate:g})}}k.urlRoot="https://jsonplaceholder.typicode.com/todos";const y=(e,t)=>({id:e.id,...t}),f=(e,t)=>t,g=e=>e;var v=n(87462),b=n(50776),E=n(86010),N=n(95999),w=n(52263),I=n(72389),x=n(83229),C=n(55423),Z=n(84195),T=n(58699),P=n(28808),V=n(96714),S=n(28224),D=n(80944),O=n(89521),L=n(91262);const U="playgroundContainer_1vxj",F="row_3g4V",A="hidden_2rz-",j="playgroundHeader_2X75",_="playgroundEditor_1tQZ",M="playgroundPreview_3d_E",R="playgroundResult_5IAE",H="debugToggle_2KFu",$="tabControls_vH2K",z="tabs_1lMe",B="tab_3qyO",q="selected_3AAM";var K=n(60522),X=n(80126),G=n(85350);function J({value:e}){const{isDarkTheme:t}=(0,G.Z)(),n=(0,a.useMemo)((()=>({String:"rgb(195, 232, 141)",Date:"rgb(247, 140, 108)",Number:"rgb(247, 140, 108)",Boolean:"rgb(247, 140, 108)",Null:"rgb(255, 88, 116)",Undefined:"rgb(255, 88, 116)",Function:"rgb(247, 140, 108)",Symbol:"rgb(247, 140, 108)"})),[]);return a.createElement(X.ZP,{shouldExpandNode:Q,data:e,theme:{tree:{overflow:"auto",flex:"4 1 70%",margin:0,padding:"0 0.5rem","background-color":t?"var(--ifm-pre-background)":"rgb(41, 45, 62)",font:"var(--ifm-code-font-size) / var(--ifm-pre-line-height) var(--ifm-font-family-monospace) !important"},arrowContainer:({style:e},t)=>({style:{...e,"font-family":"arial"}}),arrowSign:{color:"rgb(130, 170, 255)"},label:{color:"rgb(130, 170, 255)"},itemRange:{color:"rgb(105, 112, 152)"},valueText:({style:e},t)=>({style:{...e,color:n[t]}}),base0B:"rgb(191, 199, 213)"}})}function Q(e,t,n){return 0===n||(!(1!==n||!["entities","results"].includes(e[0]))||(2===n&&"entities"===e[1]||(2===n&&"results"===e[1]||(3===n&&"entities"===e[2]||3===n&&"results"===e[2]))))}function W({toggle:e,selectedValue:t}){return a.createElement(a.Fragment,null,a.createElement("div",{className:H,onClick:e},"Store"),"y"===t?a.createElement(te,null):null)}const Y=(0,a.memo)(W);function ee(){const e=(0,a.useContext)(K.sA),t=(0,a.useMemo)((()=>{const t={...e};return delete t.optimistic,delete t.lastReset,t}),[e]);return a.createElement(J,{value:t})}const te=(0,a.memo)(ee);function ne({groupId:e,defaultOpen:t,row:n}){const{tabGroupChoices:r,setTabGroupChoices:i}=(0,D.Z)(),[l,s]=(0,a.useState)(t),{blockElementScrollPositionUntilNextRender:o}=(0,O.o5)();if(null!=e){const t=r[e];null!=t&&t!==l&&s(t)}const c=(0,a.useCallback)((t=>{o(t.currentTarget),s((e=>"y"===e?"n":"y")),i(e,"y"===l?"n":"y")}),[o,e,l,i]),u=(0,a.useMemo)((()=>[new S.Z,new T.Z(P.Z)]),[]),d=!("n"===l||!n);return a.createElement(V.nq,{managers:u},a.createElement("div",{className:(0,E.Z)(M,{[A]:d})},a.createElement(L.Z,{fallback:a.createElement(re,null)},(()=>a.createElement(a.Suspense,{fallback:a.createElement(re,null)},a.createElement(b.i5,null),a.createElement(b.IF,null))))),a.createElement(Y,{selectedValue:l,toggle:c}))}const ae=(0,a.memo)(ne);function re(){return a.createElement("div",null,"Loading...")}function ie({children:e,className:t}){return a.createElement("div",{className:(0,E.Z)(j,t)},e)}function le({groupId:e,defaultOpen:t,row:n}){return a.createElement("div",null,a.createElement(ie,null,a.createElement(N.Z,{id:"theme.Playground.result",description:"The result label of the live codeblocks"},"Result")),a.createElement("div",{className:R},a.createElement(ae,{groupId:e,defaultOpen:t,row:n})))}function se(){const{selectedValue:e,setSelectedValue:t,values:n}=(0,a.useContext)(Z.Z);return a.createElement("div",{className:z,role:"tablist","aria-orientation":"horizontal"},n.map((({value:n,label:r})=>a.createElement("div",{role:"tab",tabIndex:e===n?0:-1,"aria-selected":e===n,key:n,className:(0,E.Z)(B,{[q]:e===n}),onFocus:t,onClick:t,value:n},r))))}function oe({children:e}){return a.createElement(ie,{className:$},a.createElement("div",null,e),a.createElement(se,null))}function ce({title:e}){const{values:t}=(0,a.useContext)(Z.Z),n=t.length>0,r=(0,I.Z)();return a.createElement("div",null,n?a.createElement(oe,null,e):a.createElement(ie,null,e),a.createElement(b.uz,{key:r,className:_}))}function ue({children:e,transformCode:t,groupId:n,defaultOpen:r,row:i,hidden:l=!1,...s}){const{siteConfig:{themeConfig:{liveCodeBlock:{playgroundPosition:o}}}}=(0,w.Z)(),c=(0,x.Z)();s.scope;return a.createElement("div",{className:(0,E.Z)(U,{[F]:i,[A]:l})},a.createElement(b.nu,(0,v.Z)({code:e.replace(/\n$/,""),transformCode:t||(e=>(e=>C.transpileModule(e,{compilerOptions:{module:C.ModuleKind.ESNext,target:C.ScriptTarget.ES5,jsx:"react"}}).outputText)(`${e};`)),transpileOptions:{target:{chrome:71},transforms:{classes:!1,letConst:!1,getterSetter:!1,generator:!1,asyncAwait:!1,moduleImport:!1,moduleExport:!1}},theme:c},s),"top"===o?a.createElement(a.Fragment,null,a.createElement(le,{groupId:n,defaultOpen:r,row:i}),a.createElement(ce,null)):a.createElement(a.Fragment,null,a.createElement(ce,null),a.createElement(le,{groupId:n,defaultOpen:r,row:i}))))}ce.defaultProps={title:a.createElement(N.Z,{id:"theme.Playground.liveEditor",description:"The live editor label of the live codeblocks"},"Live Editor")},ue.defaultProps={row:!1};class de extends c.Z{constructor(...e){super(...e),this.id=""}pk(){return this.id}}de.schema={updatedAt:Date};const me=new i.Z((({id:e})=>fetch(`/api/currentTime/${e}`).then((e=>e.json()))),{schema:de});const pe={...r,...o,...u,mockFetch:(e,t,n=150)=>{const a=(...t)=>new Promise((a=>setTimeout((()=>a(e(...t))),n)));return t&&Object.defineProperty(a,"name",{value:t,writable:!1}),a},BigNumber:m(),lastUpdated:me,TimedEntity:de,CurrentTime:function(){const[e,t]=(0,a.useState)((()=>new Date));return(0,a.useEffect)((()=>{const e=setInterval((()=>t(new Date)));return()=>clearInterval(e)}),[]),a.createElement("time",null,Intl.DateTimeFormat("en-US",{timeStyle:"long"}).format(e))},ResetableErrorBoundary:function({children:e}){const[t,n]=a.useState(0),{resetEntireStore:r}=l.Z();return a.createElement(s.Z,{key:t,fallbackComponent:({error:e})=>a.createElement(a.Fragment,null,a.createElement("div",null,e.message," ",a.createElement("i",null,e.status)),a.createElement("button",{onClick:()=>{r(),n((e=>e+1))}},"Clear Error"))},e)},TodoResource:class extends k{static list(){const e=super.list();return e.extend({fetch:async(...t)=>(await e(...t)).slice(0,5)})}}},he=({children:e,groupId:t,hidden:n=!1,defaultOpen:r="n",row:i=!1})=>a.createElement(ue,{scope:pe,noInline:!0,groupId:t,defaultOpen:r,row:i,hidden:n},"string"==typeof e?e:e.props.children.props.children),ke=(0,a.memo)(he)},70523:(e,t,n)=>{"use strict";n.d(t,{Z:()=>l});var a=n(9877),r=n(58215),i=n(67294);function l({children:e}){return i.createElement(a.Z,{defaultValue:"ts",groupId:"language",values:[{label:"TypeScript",value:"ts"},{label:"JavaScript",value:"js"}]},i.createElement(r.Z,{value:"ts"},e[0]),i.createElement(r.Z,{value:"js"},e[1]))}},84750:(e,t,n)=>{"use strict";n.r(t),n.d(t,{frontMatter:()=>l,contentTitle:()=>s,metadata:()=>o,toc:()=>c,default:()=>d});var a=n(87462),r=(n(27378),n(3905)),i=(n(70523),n(70720));const l={title:"schema.Values"},s=void 0,o={unversionedId:"api/Values",id:"api/Values",isDocsHomePage:!1,title:"schema.Values",description:"schema.Values - Representing Objects with arbitrary keys | Rest Hooks",source:"@site/../docs/api/Values.md",sourceDirName:"api",slug:"/api/Values",permalink:"/docs/next/api/Values",editUrl:"https://github.com/coinbase/rest-hooks/edit/master/docs/api/Values.md",tags:[],version:"current",lastUpdatedBy:"Nathaniel Tucker",lastUpdatedAt:1635114033,formattedLastUpdatedAt:"10/24/2021",frontMatter:{title:"schema.Values"},sidebar:"docs",previous:{title:"schema.Union",permalink:"/docs/next/api/Union"},next:{title:"schema.Delete",permalink:"/docs/next/api/Delete"}},c=[{value:"Instance Methods",id:"instance-methods",children:[],level:2},{value:"Usage",id:"usage",children:[{value:"Dynamic entity types",id:"dynamic-entity-types",children:[{value:"string schemaAttribute",id:"string-schemaattribute",children:[],level:4},{value:"function schemaAttribute",id:"function-schemaattribute",children:[],level:4}],level:3}],level:2}],u={toc:c};function d({components:e,...t}){return(0,r.kt)("wrapper",(0,a.Z)({},u,t,{components:e,mdxType:"MDXLayout"}),(0,r.kt)("head",null,(0,r.kt)("title",null,"schema.Values - Representing Objects with arbitrary keys | Rest Hooks")),(0,r.kt)("p",null,"Like ",(0,r.kt)("a",{parentName:"p",href:"./Array"},"Array"),", ",(0,r.kt)("inlineCode",{parentName:"p"},"Values")," are unbounded in size. The definition here describes the types of values to expect,\nwith keys being any string."),(0,r.kt)("p",null,"Describes a map whose values follow the given schema."),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"definition"),": ",(0,r.kt)("strong",{parentName:"li"},"required")," A singular schema that this array contains ",(0,r.kt)("em",{parentName:"li"},"or")," a mapping of schema to attribute values."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"schemaAttribute"),": ",(0,r.kt)("em",{parentName:"li"},"optional")," (required if ",(0,r.kt)("inlineCode",{parentName:"li"},"definition")," is not a singular schema) The attribute on each entity found that defines what schema, per the definition mapping, to use when normalizing.\nCan be a string or a function. If given a function, accepts the following arguments:",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"value"),": The input value of the entity."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"parent"),": The parent object of the input array."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"key"),": The key at which the input array appears on the parent object.")))),(0,r.kt)("h2",{id:"instance-methods"},"Instance Methods"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"define(definition)"),": When used, the ",(0,r.kt)("inlineCode",{parentName:"li"},"definition")," passed in will be merged with the original definition passed to the ",(0,r.kt)("inlineCode",{parentName:"li"},"Values")," constructor. This method tends to be useful for creating circular references in schema.")),(0,r.kt)("h2",{id:"usage"},"Usage"),(0,r.kt)(i.Z,{groupId:"schema",defaultOpen:"y",mdxType:"HooksPlayground"},(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-tsx"},"const sampleData = () =>\n  Promise.resolve({ firstThing: { id: 1 }, secondThing: { id: 2 } });\n\nclass Item extends Entity {\n  readonly id: number = 0;\n  pk() {\n    return `${this.id}`;\n  }\n}\nconst itemValues = new Endpoint(sampleData, {\n  schema: new schema.Values(Item),\n});\nfunction ItemPage() {\n  const items = useSuspense(itemValues, {});\n  return <pre>{JSON.stringify(items, undefined, 2)}</pre>;\n}\nrender(<ItemPage />);\n"))),(0,r.kt)("h3",{id:"dynamic-entity-types"},"Dynamic entity types"),(0,r.kt)("p",null,"If your input data is an object that has values of more than one type of entity, but their schema is not easily defined by the key, you can use a mapping of schema, much like ",(0,r.kt)("inlineCode",{parentName:"p"},"schema.Union")," and ",(0,r.kt)("inlineCode",{parentName:"p"},"schema.Array"),"."),(0,r.kt)("p",null,(0,r.kt)("em",{parentName:"p"},"Note: If your data returns an object that you did not provide a mapping for, the original object will be returned in the result and an entity will not be created.")),(0,r.kt)("h4",{id:"string-schemaattribute"},"string schemaAttribute"),(0,r.kt)(i.Z,{groupId:"schema",defaultOpen:"y",mdxType:"HooksPlayground"},(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-tsx"},"const sampleData = () =>\n  Promise.resolve({\n    firstLink: { id: 1, type: 'link', url: 'https://ntucker.true.io', title: 'Nate site' },\n    greatPost: { id: 10, type: 'post', content: 'good day!' },\n  });\n\nabstract class FeedItem extends Entity {\n  readonly id: number = 0;\n  declare readonly type: 'link' | 'post';\n  pk() {\n    return `${this.id}`;\n  }\n}\nclass Link extends FeedItem {\n  readonly type = 'link' as const;\n  readonly url: string = '';\n  readonly title: string = '';\n}\nclass Post extends FeedItem {\n  readonly type = 'post' as const;\n  readonly content: string = '';\n}\nconst feed = new Endpoint(sampleData, {\n  schema:\n    new schema.Values(\n      {\n        link: Link,\n        post: Post,\n      },\n      'type',\n    ),\n  ,\n});\nfunction FeedList() {\n  const feedItems = useSuspense(feed, {});\n  return (\n    <div>\n      {Object.entries(feedItems).map(([key, item]) =>\n        (<div key={item.pk()}>{key}: {item.type === 'link' ? (\n           <LinkItem link={item} />\n        ) : (\n          <PostItem post={item} />\n        )}</div>),\n      )}\n    </div>\n  );\n}\nfunction LinkItem({ link }: { link: Link }) {\n  return <a href={link.url}>{link.title}</a>;\n}\nfunction PostItem({ post }: { post: Post }) {\n  return <div>{post.content}</div>;\n}\nrender(<FeedList />);\n"))),(0,r.kt)("h4",{id:"function-schemaattribute"},"function schemaAttribute"),(0,r.kt)("p",null,"The return values should match a key in the ",(0,r.kt)("inlineCode",{parentName:"p"},"definition"),". Here we'll show the same behavior as the 'string'\ncase, except we'll append an 's'."),(0,r.kt)(i.Z,{groupId:"schema",defaultOpen:"y",mdxType:"HooksPlayground"},(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-tsx"},"const sampleData = () =>\n  Promise.resolve({\n    firstLink: { id: 1, type: 'link', url: 'https://ntucker.true.io', title: 'Nate site' },\n    greatPost: { id: 10, type: 'post', content: 'good day!' },\n  });\n\nabstract class FeedItem extends Entity {\n  readonly id: number = 0;\n  declare readonly type: 'link' | 'post';\n  pk() {\n    return `${this.id}`;\n  }\n}\nclass Link extends FeedItem {\n  readonly type = 'link' as const;\n  readonly url: string = '';\n  readonly title: string = '';\n}\nclass Post extends FeedItem {\n  readonly type = 'post' as const;\n  readonly content: string = '';\n}\nconst feed = new Endpoint(sampleData, {\n  schema:\n    new schema.Values(\n      {\n        links: Link,\n        posts: Post,\n      },\n(input: any, parent: unknown, key: string) => `${input.type}s`,\n    ),\n  ,\n});\nfunction FeedList() {\n  const feedItems = useSuspense(feed, {});\n  return (\n    <div>\n      {Object.entries(feedItems).map(([key, item]) =>\n        (<div key={item.pk()}>{key}: {item.type === 'link' ? (\n           <LinkItem link={item} />\n        ) : (\n          <PostItem post={item} />\n        )}</div>),\n      )}\n    </div>\n  );\n}\nfunction LinkItem({ link }: { link: Link }) {\n  return <a href={link.url}>{link.title}</a>;\n}\nfunction PostItem({ post }: { post: Post }) {\n  return <div>{post.content}</div>;\n}\nrender(<FeedList />);\n"))))}d.isMDXComponent=!0},13411:e=>{function t(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}t.keys=()=>[],t.resolve=t,t.id=13411,e.exports=t},62715:()=>{},13611:()=>{},43454:()=>{}}]);